# 部署管理

## ipfs部署步骤

1. Linux or MacOS 机器（unix底层通用）
  
    脚本：/Users/ask/Documents/code/github/storage-market/scripts/auto-ipfs-docker.sh

2. Windows 机器（windows底层通用）
  
    脚本：无，就直接安装ipfs吧（（（（

## 合约部署步骤

1. 部署首页界面的存储用户管理合约

    脚本：/Users/ask/Documents/code/github/storage-market/contract/data-market/InstaShare.sol

2. 部署公开共享数据的存储合约

    脚本： /Users/ask/Documents/code/github/storage-market/contract/data-market/PublicShareSimple.sol

3. 部署存储市场交易合约

    脚本：/Users/ask/Documents/code/github/storage-market/contract/data-market/storageMarket.sol

## graphNode部署步骤

1. linux or MacOS 机器（unix底层通用）
  
    脚本：/Users/ask/Documents/code/github/storage-market/scripts/auto-graph-node-docker.sh

2. Windows 机器（windows底层通用）

    脚本：无，只能linux，别骂我，我真的不知道怎么在windows上绕弯路（（（（

## subgraph索引图部署步骤

1. 部署InstaShare合约的subgraph索引图

    文件：/Users/ask/Documents/code/github/storage-market/backend/subgraph-state-api/storage-market-instance-share_v2/storage-market-public-share

2. 部署PublicShareSimple合约的subgraph索引图

    文件：/Users/ask/Documents/code/github/storage-market/backend/subgraph-state-api/storage-market-public-share-simple/v2/storage-market-public-share-

3. 部署StorageMarket合约的subgraph索引图

    文件：/Users/ask/Documents/code/github/storage-market/backend/subgraph-state-api/storage-market

## 新版本（包含多节点注册购买协议）subgraph索引图部署步骤

1. 部署InstaShare合约的subgraph索引图

    文件：/Users/ask/Documents/code/github/storage-market/backend/subgraph-state-api/storage-market-instance-share_v2/storage-market-instance-share

2. 部署PublicShareSimple合约的subgraph索引图

    文件：/Users/ask/Documents/code/github/storage-market/backend/subgraph-state-api/storage-market-public-share-simple/v2/storage-market-public-share-

3. 部署StorageMarket合约的subgraph索引图

    文件：/Users/ask/Documents/code/github/storage-market/backend/subgraph-state-api/storage-market-v2
 
! 注意：storageMarket合约有改动，现在可能需要修改对应的graphql schema的文件才能正确索引数据。
